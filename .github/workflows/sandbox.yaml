name: ⚙️ Sandbox
on:
  push: 
  workflow_dispatch:
    
jobs:
  playground:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/github-script@v7
        with:
          script: |
            const {owner, repo} = context.repo;
            const workflowRun = await github.rest.actions.getWorkflowRun({
              owner, repo,
              run_id: context.runId,
            }).then((res) => res.data);
            console.log("workflowRun:", workflowRun);
            
            const checkSuiteEnv = Object.fromEntries(Object.entries(process.env).filter(([name, value]) => value.includes(workflowRun.check_suite_id)));
            console.log("checkSuiteEnv:", checkSuiteEnv);

            // https://octokit.github.io/rest.js/v22/
            const checkRuns = await github.rest.checks.listForSuite({
              owner, repo,
              check_suite_id: workflowRun.check_suite_id,
              // TODO check_name
              // TODO status
              // TODO filter latest
            }).then((res) => res.data);
            console.log("checkRuns:", checkRuns);

            const checkRun = checkRuns.check_runs.find((checkRun) => checkRun.external_id == "UUID");
            console.log("checkRun:", checkRun);
                       
  
